<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="generator" content="ReSpec 32.2.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>ECDSA Cryptosuite v2019</title>
    
    
    
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
code{color:#c63501}
th code{color:inherit}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
    
  
<meta name="description" content="This specification describes a Data Integrity Cryptosuite for use when
generating a digital signature using the Elliptic Curve Digital Signature
Algorithm (ECDSA) based on the Standards for Efficient Cryptography over prime
fields using a verifiably random Elliptic Curve (secpr1). The approach is
accepted by the U.S. National Institute of Standards and meets U.S. Federal
Information Processing requirements when using cryptography to secure digital
information.">
<link rel="canonical" href="https://www.w3.org/community/reports/credentials/CG-FINAL-di-ecdsa-2019-20220724/">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "subtitle": "Achieving Data Integrity using ECDSA with NIST-compliant curves",
  "specStatus": "CG-FINAL",
  "shortName": "di-ecdsa-2019",
  "group": "credentials",
  "edDraftURI": "https://w3c-ccg.github.io/di-ecdsa-2019/",
  "latestVersion": "https://www.w3.org/community/reports/credentials/CG-FINAL-di-ecdsa-2019-20220724/",
  "editors": [
    {
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/"
    },
    {
      "name": "Marty Reed",
      "url": "https://www.linkedin.com/in/marty-reed-b5b2352/",
      "company": "RANDA Solutions",
      "companyURL": "https://www.randasolutions.com/"
    }
  ],
  "authors": [
    {
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/"
    }
  ],
  "wg": "W3C Credentials Community Group",
  "wgURI": "https://www.w3.org/community/credentials/",
  "wgPublicList": "public-credentials",
  "otherLinks": [
    {
      "key": "Source control",
      "data": [
        {
          "value": "https://github.com/digitalbazaar/di-ecdsa-2019/",
          "href": "https://github.com/digitalbazaar/di-ecdsa-2019/"
        }
      ]
    },
    {
      "key": "Issue Tracker",
      "data": [
        {
          "value": "https://github.com/digitalbazaar/di-ecdsa-2019/issues/",
          "href": "https://github.com/digitalbazaar/di-ecdsa-2019/issues/"
        }
      ]
    }
  ],
  "wgPatentURI": "",
  "maxTocLevel": 4,
  "localBiblio": {
    "RDF-DATASET-CANONICALIZATION": {
      "title": "RDF Dataset Canonicalization",
      "href": "https://json-ld.github.io/rdf-dataset-canonicalization/spec/",
      "authors": [
        "David Longley",
        "Manu Sporny"
      ],
      "status": "Draft Community Group Report",
      "publisher": "JSON-LD Community Group",
      "id": "rdf-dataset-canonicalization"
    },
    "SECURITY-VOCABULARY": {
      "title": "Security Linked Data Vocabulary",
      "href": "https://web-payments.org/vocabs/security",
      "authors": [
        "Manu Sporny",
        "David Longley"
      ],
      "status": "Draft Community Group Report",
      "publisher": "Web Payments Community Group"
    },
    "DATA-INTEGRITY": {
      "title": "Data Integrity 1.0",
      "href": "https://w3c-ccg.github.io/data-integrity-spec/",
      "authors": [
        "David Longley",
        "Manu Sporny"
      ],
      "status": "Draft Community Group Report",
      "publisher": "Credentials Community Group",
      "id": "data-integrity"
    },
    "FIPS-186-4": {
      "title": "FIPS PUB 186-4: Digital Signature Standard (DSS)",
      "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf",
      "status": "National Standard",
      "publisher": "U.S. Department of Commerce/National Institute of Standards and Technology",
      "id": "fips-186-4"
    }
  },
  "publishISODate": "2022-07-24T00:00:00.000Z",
  "generatedSubtitle": "Final Community Group Report 24 July 2022"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/cg-final"></head>
  <body class="h-entry"><div class="head">
    
    <h1 id="title" class="title">ECDSA Cryptosuite v2019</h1> <h2 id="subtitle" class="subtitle">Achieving Data Integrity using ECDSA with NIST-compliant curves</h2>
    <p id="w3c-state">
      <a href="https://www.w3.org/standards/types#reports">Final Community Group Report</a>
      <time class="dt-published" datetime="2022-07-24">24 July 2022</time>
    </p>
    <dl>
      <dt>This version:</dt><dd>
              <a class="u-url" href="https://www.w3.org/community/reports/credentials/CG-FINAL-di-ecdsa-2019-20220724/">https://www.w3.org/community/reports/credentials/CG-FINAL-di-ecdsa-2019-20220724/</a>
            </dd>
      <dt>Latest published version:</dt><dd>
              <a href="https://www.w3.org/community/reports/credentials/CG-FINAL-di-ecdsa-2019-20220724/">https://www.w3.org/community/reports/credentials/CG-FINAL-di-ecdsa-2019-20220724/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://w3c-ccg.github.io/di-ecdsa-2019/">https://w3c-ccg.github.io/di-ecdsa-2019/</a></dd>
      
      
      
      
      <dt>Editors:</dt><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/manusporny/">Manu Sporny</a> (<a class="p-org org h-org" href="https://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/marty-reed-b5b2352/">Marty Reed</a> (<a class="p-org org h-org" href="https://www.randasolutions.com/">RANDA Solutions</a>)
  </dd>
      
      <dt>Author:</dt><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/manusporny/">Manu Sporny</a> (<a class="p-org org h-org" href="https://digitalbazaar.com/">Digital Bazaar</a>)
  </dd>
      <dt>Feedback:</dt><dd><a href="mailto:public-credentials@w3.org?subject=%5Bdi-ecdsa-2019%5D%20YOUR%20TOPIC%20HERE">public-credentials@w3.org</a> with subject line <kbd>[di-ecdsa-2019] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-credentials">archives</a>)</dd>
    </dl>
    
    <p class="copyright">
          <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
          ©
          2022
          
          the Contributors to the ECDSA Cryptosuite v2019
          Specification, published by the
          <a href="https://www.w3.org/groups/cg/credentials">Credentials Community Group</a> under the
          <a href="https://www.w3.org/community/about/agreements/fsa/">W3C Community Final Specification Agreement (FSA)</a>. A human-readable
                <a href="https://www.w3.org/community/about/agreements/fsa-deed/">summary</a>
                is available.
              
        </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
This specification describes a Data Integrity Cryptosuite for use when
generating a digital signature using the Elliptic Curve Digital Signature
Algorithm (ECDSA) based on the Standards for Efficient Cryptography over prime
fields using a verifiably random Elliptic Curve (secpr1). The approach is
accepted by the U.S. National Institute of Standards and meets U.S. Federal
Information Processing requirements when using cryptography to secure digital
information.
      </p>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/groups/cg/credentials">Credentials Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/final/">W3C Community Final Specification Agreement (FSA)</a>
            other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p>
      <p>
This is an experimental specification and is undergoing regular revisions. It
is not fit for production deployment.
      </p>
    <p>
    If you wish to make comments regarding this document, please send them to
    <a href="mailto:public-credentials@w3.org">public-credentials@w3.org</a>
    (<a href="mailto:public-credentials-request@w3.org?subject=subscribe">subscribe</a>,
    <a href="https://lists.w3.org/Archives/Public/public-credentials/">archives</a>).
  </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.1 </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.2 </bdi>Terminology</a></li></ol></li><li class="tocline"><a class="tocxref" href="#data-model"><bdi class="secno">2. </bdi>Data Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#key-formats"><bdi class="secno">2.1 </bdi>Key Formats</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ecdsasecp256r1verificationkey2019"><bdi class="secno">2.1.1 </bdi>EcdsaSecp256r1VerificationKey2019</a></li><li class="tocline"><a class="tocxref" href="#ecdsasecp384r1verificationkey2019"><bdi class="secno">2.1.2 </bdi>EcdsaSecp384r1VerificationKey2019</a></li><li class="tocline"><a class="tocxref" href="#key-format-examples"><bdi class="secno">2.1.3 </bdi>Key Format Examples</a></li></ol></li><li class="tocline"><a class="tocxref" href="#signature-formats"><bdi class="secno">2.2 </bdi>Signature Formats</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ecdsasecp256r1signature2019"><bdi class="secno">2.2.1 </bdi>EcdsaSecp256r1Signature2019</a></li><li class="tocline"><a class="tocxref" href="#ecdsasecp384r1signature2019"><bdi class="secno">2.2.2 </bdi>EcdsaSecp384r1Signature2019</a></li><li class="tocline"><a class="tocxref" href="#signature-format-examples"><bdi class="secno">2.2.3 </bdi>Signature Format Examples</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">3. </bdi>Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#modifications-to-signature-algorithm"><bdi class="secno">3.1 </bdi>Modifications to Signature Algorithm</a></li><li class="tocline"><a class="tocxref" href="#modifications-to-signature-verification-algorithm"><bdi class="secno">3.2 </bdi>Modifications to Signature Verification Algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">4. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#split-key-formats-from-cryptosuites"><bdi class="secno">4.1 </bdi>Split Key Formats From Cryptosuites</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">A.1 </bdi>Normative references</a></li></ol></li></ol></nav>

    <section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
      
      <p>
This specification describes the EcdsaSecp384r1Signature and
EcdsaSecp256r1Signature created in 2019 for the Data Integrity
[<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>] specification. It uses the RDF Dataset Canonicalization
Algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-canonicalization" title="RDF Dataset Canonicalization">RDF-DATASET-CANONICALIZATION</a></cite>] to transform the input document into
its canonical form. It uses one of two mechanisms to digest and sign: SHA-256
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>] as the <a href="#dfn-message-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-message-digest-algorithm-1">message digest algorithm</a> and ECDSA with Curve P-256
defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-186-4" title="FIPS PUB 186-4: Digital Signature Standard (DSS)">FIPS-186-4</a></cite>] as the <a href="#dfn-signature-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-algorithm-1">signature algorithm</a>, or SHA-384
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>] as the <a href="#dfn-message-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-message-digest-algorithm-2">message digest algorithm</a> and ECDSA with Curve P-384
defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-186-4" title="FIPS PUB 186-4: Digital Signature Standard (DSS)">FIPS-186-4</a></cite>] as the <a href="#dfn-signature-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-algorithm-2">signature algorithm</a>.
      </p>

      <section id="conformance"><div class="header-wrapper"><h3 id="x1-1-conformance"><bdi class="secno">1.1 </bdi>Conformance</h3><a class="self-link" href="#conformance" aria-label="Permalink for Section 1.1"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key word <em class="rfc2119">MUST</em> in this document
        is to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>

      <section id="terminology"><div class="header-wrapper"><h3 id="x1-2-terminology"><bdi class="secno">1.2 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.2"></a></div>
        
        <p>
The following terms are used throughout this document:
        </p>

        <dl>
          <dt><dfn data-plurals="signature suites" id="dfn-signature-suite" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">signature suite</dfn></dt>
          <dd>
A specified set of cryptographic primitives typically consisting of
a canonicalization algorithm, a message digest algorithm, and a signature
algorithm that are bundled together by cryptographers for developers
for the purposes of safety and convenience.
          </dd>
          <dt><dfn class="lint-ignore" id="dfn-canonicalization-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">canonicalization algorithm</dfn></dt>
          <dd>
An algorithm that takes an input document that has more than one possible
representation and always transforms it into a canonical form. This process is
sometimes also called <em>normalization</em>.
          </dd>
          <dt><dfn id="dfn-message-digest-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">message digest algorithm</dfn></dt>
          <dd>
An algorithm that takes an input message and produces a cryptographic
output message that is often many orders of magnitude smaller than the
input message. These algorithms are often 1) very fast, 2)
non-reversible, 3) cause the output to change significantly when even one
bit of the input message changes, and 4) make it infeasible to find two
different inputs for the same output.
          </dd>
          <dt><dfn id="dfn-signature-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">signature algorithm</dfn></dt>
          <dd>
An algorithm that takes an input message and produces an output value where the
receiver of the message can mathematically verify that the message has not
been modified in transit and came from someone possessing a particular secret.
          </dd>
        </dl>
      </section>
    </section>

    <section id="data-model"><div class="header-wrapper"><h2 id="x2-data-model"><bdi class="secno">2. </bdi>Data Model</h2><a class="self-link" href="#data-model" aria-label="Permalink for Section 2."></a></div>
      
      <p>
This specification defines a data model for a number of key formats and
signature formats.
      </p>

      <section id="key-formats"><div class="header-wrapper"><h3 id="x2-1-key-formats"><bdi class="secno">2.1 </bdi>Key Formats</h3><a class="self-link" href="#key-formats" aria-label="Permalink for Section 2.1"></a></div>
        

        <div class="issue" id="issue-container-number-1"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><span>Issue 1</span><span class="issue-label">: Refer normatively to a Multikey specification</span></div><p class="">
This specification should not specify multikey formats. It should, instead,
point to a multikey registry and/or specification. Examples of these
sorts of documents include the DID Specification Registries for <a href="https://w3c.github.io/did-spec-registries/#verification-method-types">
Verification Method Types</a>, the key types in the <a href="https://ns.did.ai/suites/multikey-2021/v1/">
Multikey2021 JSON-LD Context</a>, and key definitions in the <a href="https://w3c-ccg.github.io/security-vocab/">Security Vocabulary</a>.
Ideally, the specification that this one points to would define all possible
multikeys listed in the <a href="https://github.com/multiformats/multicodec/blob/master/table.csv">Multicodec Registry</a>
and define how to encode them as multibase values in fields such as
<code>publicKeyMultibase</code> and <code>secretKeyMultibase</code>. The referenced specification
should also include an extensbility mechanism and registry for new values as
they are added to the Multicodec Registry.
        </p></div>

        <p>
The following two key formats are defined by this specification:
        </p>

        <section id="ecdsasecp256r1verificationkey2019"><div class="header-wrapper"><h4 id="x2-1-1-ecdsasecp256r1verificationkey2019"><bdi class="secno">2.1.1 </bdi>EcdsaSecp256r1VerificationKey2019</h4><a class="self-link" href="#ecdsasecp256r1verificationkey2019" aria-label="Permalink for Section 2.1.1"></a></div>
          
          <p>
A Curve P-256 compressed public key as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-186-4" title="FIPS PUB 186-4: Digital Signature Standard (DSS)">FIPS-186-4</a></cite>]. The key <em class="rfc2119">MUST</em>
contain a <code>type</code> set to <code>EcdsaSecp256r1VerificationKey2019</code>, <code>controller</code>, and
<code>publicKeyMultibase</code> value as defined by this specification.
          </p>
        </section>
        <section id="ecdsasecp384r1verificationkey2019"><div class="header-wrapper"><h4 id="x2-1-2-ecdsasecp384r1verificationkey2019"><bdi class="secno">2.1.2 </bdi>EcdsaSecp384r1VerificationKey2019</h4><a class="self-link" href="#ecdsasecp384r1verificationkey2019" aria-label="Permalink for Section 2.1.2"></a></div>
          
          <p>
A Curve P-384 compressed public key. The key <em class="rfc2119">MUST</em> contain a <code>type</code> set to
<code>EcdsaSecp384r1VerificationKey2019</code>, <code>controller</code>, and <code>publicKeyMultibase</code>
value as defined by this specification.
          </p>
        </section>

	      <section id="key-format-examples"><div class="header-wrapper"><h4 id="x2-1-3-key-format-examples"><bdi class="secno">2.1.3 </bdi>Key Format Examples</h4><a class="self-link" href="#key-format-examples" aria-label="Permalink for Section 2.1.3"></a></div>
          

          <p>
An encoded Curve P-384 public key:
          </p>

          <div class="example" id="example-1">
        <div class="marker">
    <a class="self-link" href="#example-1">Example<bdi> 1</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs">{
  "@context": ["https://w3id.org/security/suites/ecdsa-2019/v1"],
  "id": "did:example:123456789abcdefghi#keys-1",
  "type": "EcdsaSecp384r1VerificationKey2019",
  "controller": "did:example:123456789abcdefghi",
  "publicKeyMultibase" : "zsJV1eTDACogBS8FMj5vXSa51g1CY1y88DR2DGDwTsMTotTG
			  ELVH1XTEsFP8ok9q22ssAaqHN5fMgm1kweTABZZNRSc"
}</code></pre>
      </div>

          <div class="issue" id="issue-container-number-2"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="5"><span>Issue 2</span><span class="issue-label">: Avoid key format proliferation by using multikey header value</span></div><p class="">
The pattern that Data Integrity Verification Keys use presently leads to an
proliferation in key types and JSON-LD Contexts. This proliferation can be
avoided without any loss of the single-field precision benefits of a
multibase-encoded multicodec public key. The only downside for the approach
demonstrated below is the loss of human-readable key type information. It could
be argued that developers shouldn't be provided such affordances to ensure that
they do not meddle with the values. Software libraries would ensure that the
multicodec header information matches the expected header based on the
cryptosuite that is utilizing the key for verification. See the section on
<a href="#signature-format-examples" class="sec-ref"><bdi class="secno">2.2.3 </bdi>Signature Format Examples</a> for more information.
          </p></div>

          <div class="example" id="example-a-multibase-encoded-multicodec-curve-p-384-public-key">
        <div class="marker">
    <a class="self-link" href="#example-a-multibase-encoded-multicodec-curve-p-384-public-key">Example<bdi> 2</bdi></a><span class="example-title">: A Multibase-encoded Multicodec Curve P-384 public key</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs">{
  "@context": ["https://w3id.org/security/multikey/v1"],
  "id": "did:example:123456789abcdefghi#keys-1",
  "type": "MulticodecVerificationKey",
  "controller": "did:example:123456789abcdefghi",
  "publicKeyMultibase" : "zsJV1eTDACogBS8FMj5vXSa51g1CY1y88DR2DGDwTsMTotTG
			  ELVH1XTEsFP8ok9q22ssAaqHN5fMgm1kweTABZZNRSc"
}</code></pre>
      </div>


      </section>
    </section>

    <section id="signature-formats"><div class="header-wrapper"><h3 id="x2-2-signature-formats"><bdi class="secno">2.2 </bdi>Signature Formats</h3><a class="self-link" href="#signature-formats" aria-label="Permalink for Section 2.2"></a></div>
      

      <p>
The <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-1">signature suites</a> listed in this specification <em class="rfc2119">MUST</em> be used in
conjunction with the signing and verification algorithms in the
Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>] specification. The following two signature
formats are defined by this specification.
      </p>

      <section id="ecdsasecp256r1signature2019"><div class="header-wrapper"><h4 id="x2-2-1-ecdsasecp256r1signature2019"><bdi class="secno">2.2.1 </bdi>EcdsaSecp256r1Signature2019</h4><a class="self-link" href="#ecdsasecp256r1signature2019" aria-label="Permalink for Section 2.2.1"></a></div>
        
        <p>
A document that complies with the Data Integrity specification has been signed
with EcdsaSecp256r1Signature2019 when it contains a <code>proof</code> value, and that
value contains a <code>type</code> set to <code>EcdsaSecp256r1Signature2019</code>, a <code>proofPurpose</code>,
<code>verificationMethod</code>, and <code>proofValue</code>, as is defined by this specification.
        </p>

        <p>
The suite consists of the following algorithms:
        </p>

        <table class="simple">
          <thead>
            <tr><th>Parameter</th>
            <th>Value</th>
            <th>Specification</th>
          </tr></thead>
          <tbody>
            <tr>
              <td>canonicalizationAlgorithm</td>
              <td>https://w3id.org/security#GCA2015</td>
              <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-canonicalization" title="RDF Dataset Canonicalization">RDF-DATASET-CANONICALIZATION</a></cite>]</td>
            </tr>
            <tr>
              <td>digestAlgorithm</td>
              <td>https://www.iana.org/assignments/cose/cose.xhtml#SHA-256</td>
              <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>]</td>
            </tr>
            <tr>
              <td>signatureAlgorithm</td>
              <td>https://www.iana.org/assignments/cose/cose.xhtml#P-256</td>
              <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8422" title="Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier">RFC8422</a></cite>]</td>
            </tr>
          </tbody>
        </table>

    </section>

    <section id="ecdsasecp384r1signature2019"><div class="header-wrapper"><h4 id="x2-2-2-ecdsasecp384r1signature2019"><bdi class="secno">2.2.2 </bdi>EcdsaSecp384r1Signature2019</h4><a class="self-link" href="#ecdsasecp384r1signature2019" aria-label="Permalink for Section 2.2.2"></a></div>
      
      <p>
  A document that complies with the Data Integrity specification has been signed
  with EcdsaSecp384r1Signature2019 when it contains a <code>proof</code> value, and that
  value contains a <code>type</code> set to <code>EcdsaSecp384r1Signature2019</code>, a <code>proofPurpose</code>,
  <code>verificationMethod</code>, and <code>proofValue</code>, as is defined by this specification.
      </p>

      <p>
  The suite consists of the following algorithms:
      </p>

      <table class="simple">
        <thead>
          <tr><th>Parameter</th>
          <th>Value</th>
          <th>Specification</th>
        </tr></thead>
        <tbody>
          <tr>
            <td>canonicalizationAlgorithm</td>
            <td>https://w3id.org/security#GCA2015</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-canonicalization" title="RDF Dataset Canonicalization">RDF-DATASET-CANONICALIZATION</a></cite>]</td>
          </tr>
          <tr>
            <td>digestAlgorithm</td>
            <td>https://www.iana.org/assignments/cose/cose.xhtml#SHA-384</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>]</td>
          </tr>
          <tr>
            <td>signatureAlgorithm</td>
            <td>https://www.iana.org/assignments/cose/cose.xhtml#P-384</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8422" title="Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier">RFC8422</a></cite>]</td>
          </tr>
        </tbody>

      </table>

    </section>

    <section id="signature-format-examples"><div class="header-wrapper"><h4 id="x2-2-3-signature-format-examples"><bdi class="secno">2.2.3 </bdi>Signature Format Examples</h4><a class="self-link" href="#signature-format-examples" aria-label="Permalink for Section 2.2.3"></a></div>
      

      <p>
An data integrity digital signature using ECDSA with Curve P-384:
      </p>

      <div class="example" id="example-3">
        <div class="marker">
    <a class="self-link" href="#example-3">Example<bdi> 3</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs">{
  "@context": ["https://w3id.org/security/suites/ecdsa-2019/v1"],
  "type": "EcdsaSecp384r1Signature2019",
  "created": "2022-01-29T20:35:38Z",
  "verificationMethod": "did:example:123456789abcdefghi#keys-1",
  "proofPurpose": "assertionMethod",
  "proofValue": "z2rb7doJxczUFBTdV5F5pehtbUXPDUgKVugZZ99jniVXCUpojJ9PqLYV
                 evMeB1gCyJ4HqpnTyQwaoRPWaD3afEZboXCBTdV5F5pehtbUXPDUgKVugUpoj"
}</code></pre>
      </div>

      <div class="issue" id="issue-container-number-3"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="5"><span>Issue 3</span><span class="issue-label">: Avoid signature format proliferation by using text-based suite value</span></div><p class="">
The pattern that Data Integrity Signatures use presently leads to an
proliferation in signature types and JSON-LD Contexts. This proliferation can be
avoided without any loss of the security characteristics of tightly binding  a
cryptography suite version to one or more acceptable public keys.  See
<a href="#key-format-examples" class="sec-ref"><bdi class="secno">2.1.3 </bdi>Key Format Examples</a>  for more information on what the matching
<a href="#example-a-multibase-encoded-multicodec-curve-p-384-public-key">
MulticodecVerificationKey format</a> could look like. The following signature
suites are currently being contemplated: Eddsa2022, NistEcdsa2022,
KoblitzEcdsa2022, Pgp2022, GostDsa2022, Sm9Ibsa2022, and Jws2022.
      </p></div>

      <div class="example" id="example-a-dataintegritysignature-example-using-a-nistecdsa2019-cryptosuite">
        <div class="marker">
    <a class="self-link" href="#example-a-dataintegritysignature-example-using-a-nistecdsa2019-cryptosuite">Example<bdi> 4</bdi></a><span class="example-title">: A DataIntegritySignature example using a NistEcdsa2019 Cryptosuite</span>
  </div> <pre aria-busy="false"><code class="hljs">{
  "@context": ["https://w3id.org/security/data-integrity/v1"],
  "type": "DataIntegritySignature",
  "cryptosuite": "NistEcdsa2022",
  "created": "2021-11-29T20:35:38Z",
  "verificationMethod": "did:example:123456789abcdefghi#keys-1",
  "proofPurpose": "assertionMethod",
  "proofValue": "z2rb7doJxczUFBTdV5F5pehtbUXPDUgKVugZZ99jniVXCUpojJ9PqLYV
                 evMeB1gCyJ4HqpnTyQwaoRPWaD3afEZboXCBTdV5F5pehtbUXPDUgKVugUpoj"
}</code></pre>
      </div>

    </section>

  </section>
</section>

    <section id="algorithms"><div class="header-wrapper"><h2 id="x3-algorithms"><bdi class="secno">3. </bdi>Algorithms</h2><a class="self-link" href="#algorithms" aria-label="Permalink for Section 3."></a></div>
      

      <p>
This signature suite uses ECDSA over Curve P-256 or Curve P-384 as described in
[<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-186-4" title="FIPS PUB 186-4: Digital Signature Standard (DSS)">FIPS-186-4</a></cite>]. The steps to construct and verify the digital signature are
defined below.
      </p><p>

      </p><section id="modifications-to-signature-algorithm"><div class="header-wrapper"><h3 id="x3-1-modifications-to-signature-algorithm"><bdi class="secno">3.1 </bdi>Modifications to Signature Algorithm</h3><a class="self-link" href="#modifications-to-signature-algorithm" aria-label="Permalink for Section 3.1"></a></div>
        

        <p>
The <var>digital signature algorithm</var> takes <var>tbs</var>, a
<var>privateKey</var>, and <var>options</var> as inputs and produces a
<var>signatureValue</var> as output.
        </p>
        <ol class="algorithm">
          <li>
Take <var>tbs</var>, which is the cryptographic hash of the data to be signed, a
set of raw <var>privateKey</var> bytes, and an <var>options</var> dictionary as
input to the signature suite.
          </li>
          <li>
Perform the digital signature on <var>tbs</var> using the ECDSA digital
signature algorithm using the requested curve (either Curve P-256 or P-384), as
defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-186-4" title="FIPS PUB 186-4: Digital Signature Standard (DSS)">FIPS-186-4</a></cite>] and store the result as <var>signatureValue</var>.
          </li>
          <li>
Update <var>signatureValue</var> by multibase-encoding the value using the
the base58btc encoding.
          </li>
        </ol>

      </section>

    <section id="modifications-to-signature-verification-algorithm"><div class="header-wrapper"><h3 id="x3-2-modifications-to-signature-verification-algorithm"><bdi class="secno">3.2 </bdi>Modifications to Signature Verification Algorithm</h3><a class="self-link" href="#modifications-to-signature-verification-algorithm" aria-label="Permalink for Section 3.2"></a></div>
        

        <p>
The <var>digital signature algorithm</var> defined Signature Verification
Algorithm takes the value to be verified, <em>tbv</em>, the <em>public key</em>
to the signature algorithm and returns a boolean value.
        </p>
        <ol class="algorithm">
          <li>
Multibase decode <var>tbv</var> using the base58btc alphabet and store the
result in <var>rawSignature</var>.
          </li>
          <li>
Take <var>rawSignature</var> and perform the digital signature verification
algorithm associated with the provided <em>public key</em> as specified in
[<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-186-4" title="FIPS PUB 186-4: Digital Signature Standard (DSS)">FIPS-186-4</a></cite>]. If the result is a valid signature, return <code>true</code>,
otherwise return <code>false</code>.
          </li>
        </ol>

      </section>

    </section>

    <section id="security-considerations"><div class="header-wrapper"><h2 id="x4-security-considerations"><bdi class="secno">4. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 4."></a></div>
      
      <p>
The following section describes security considerations that developers
implementing this specification should be aware of in order to create secure
software.
      </p>

      <section id="split-key-formats-from-cryptosuites"><div class="header-wrapper"><h3 id="x4-1-split-key-formats-from-cryptosuites"><bdi class="secno">4.1 </bdi>Split Key Formats From Cryptosuites</h3><a class="self-link" href="#split-key-formats-from-cryptosuites" aria-label="Permalink for Section 4.1"></a></div>
        

        <div class="issue" id="issue-container-number-4"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="4"><span>Issue 4</span></div><p class="">
Ensuring that cryptographic suites are versioned and tightly scoped to a very
small set of possible key types and signature schemes (ideally one key type and
size and one signature output type) is a design goal for most Data Integrity
cryptographic suites. Historically, this has been done by defining both the
key type and the cryptographic suite that uses the key type in the same
specification. The downside of doing so, however, is that there might be a
proliferation of different key types in multikey that result in different
cryptosuites defining the same key material differently. For example, one
cryptosuite might use compressed Curve P-256 keys while another uses
uncompressed values. If that occurs, it will harm interoperability. It will be
important in the coming months to years to ensure that this does not happen
by fully defining the multikey format in a separate specification so
cryptosuite specifications, such as this one, can refer to the multikey
specification, thus reducing the chances of multikey type proliferation and
improving the chances of maximum interoperability for the multikey format.
        </p></div>

      </section>

<div class="issue" id="issue-container-number-5"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="3"><span>Issue 5</span></div><div class="">TODO: We need to add a complete list of security
considerations.</div></div>



    </section>

  

<div style="position: static !important;"></div><section id="references" class="appendix"><div class="header-wrapper"><h2 id="a-references"><bdi class="secno">A. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix A."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="a-1-normative-references"><bdi class="secno">A.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix A.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-data-integrity">[DATA-INTEGRITY]</dt><dd>
      <a href="https://w3c-ccg.github.io/data-integrity-spec/"><cite>Data Integrity 1.0</cite></a>. David Longley; Manu Sporny.  Credentials Community Group. Draft Community Group Report. URL: <a href="https://w3c-ccg.github.io/data-integrity-spec/">https://w3c-ccg.github.io/data-integrity-spec/</a>
    </dd><dt id="bib-fips-186-4">[FIPS-186-4]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf"><cite>FIPS PUB 186-4: Digital Signature Standard (DSS)</cite></a>.  U.S. Department of Commerce/National Institute of Standards and Technology. National Standard. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf</a>
    </dd><dt id="bib-rdf-dataset-canonicalization">[RDF-DATASET-CANONICALIZATION]</dt><dd>
      <a href="https://json-ld.github.io/rdf-dataset-canonicalization/spec/"><cite>RDF Dataset Canonicalization</cite></a>. David Longley; Manu Sporny.  JSON-LD Community Group. Draft Community Group Report. URL: <a href="https://json-ld.github.io/rdf-dataset-canonicalization/spec/">https://json-ld.github.io/rdf-dataset-canonicalization/spec/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc6234">[RFC6234]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6234"><cite>US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)</cite></a>. D. Eastlake 3rd; T. Hansen.  IETF. May 2011. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc6234">https://www.rfc-editor.org/rfc/rfc6234</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8422">[RFC8422]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8422"><cite>Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier</cite></a>. Y. Nir; S. Josefsson; M. Pegourie-Gonnard.  IETF. August 2018. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8422">https://www.rfc-editor.org/rfc/rfc8422</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-signature-suite" aria-label="Links in this document to definition: signature suite">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-signature-suite" aria-label="Permalink for definition: signature suite. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-signature-suite-1" title="§ 2.2 Signature Formats">§ 2.2 Signature Formats</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-canonicalization-algorithm" aria-label="Links in this document to definition: canonicalization algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-canonicalization-algorithm" aria-label="Permalink for definition: canonicalization algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-message-digest-algorithm" aria-label="Links in this document to definition: message digest algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-message-digest-algorithm" aria-label="Permalink for definition: message digest algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-message-digest-algorithm-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-message-digest-algorithm-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-signature-algorithm" aria-label="Links in this document to definition: signature algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-signature-algorithm" aria-label="Permalink for definition: signature algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-signature-algorithm-1" title="§ 1. Introduction">§ 1. Introduction</a> <a href="#ref-for-dfn-signature-algorithm-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>