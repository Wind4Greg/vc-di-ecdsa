<!DOCTYPE html>
<html>
  <head>
    <title>Ecdsa Secp384r1 Cryptosuite v2019</title>
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
    <!--
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     -->
    <script src='//www.w3.org/Tools/respec/respec-w3c-common' class='remove'></script>
    <script type="text/javascript" class="remove">
      var respecConfig = {
        // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
        specStatus:           "CG-DRAFT",

        // the specification's short name, as in http://www.w3.org/TR/short-name/
        shortName:            "lds-ecdsa-secp384r1-2019",

        // if you wish the publication date to be other than today, set this
        // publishDate:  "2009-08-06",

        // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
        // and its maturity status
        // previousPublishDate:  "1977-03-15",
        // previousMaturity:  "WD",


        // if there a publicly available Editor's Draft, this is the link
        edDraftURI: "https://digitalbazaar.github.io/lds-ecdsa-secp384r1-2019/",

        // if this is a LCWD, uncomment and set the end of its review period
        // lcEnd: "2009-08-05",

        // if you want to have extra CSS, append them to this list
        // it is recommended that the respec.css stylesheet be kept
        //extraCSS:             ["spec.css", "prettify.css"],

        // editors, add as many as you like
        // only "name" is required
        editors: [{
          name: "Manu Sporny", url: "https://www.linkedin.com/in/manusporny/",
          company: "Digital Bazaar", companyURL: "https://digitalbazaar.com/"
        }],

        // authors, add as many as you like.
        // This is optional, uncomment if you have authors as well as editors.
        // only "name" is required. Same format as editors.

        authors: [{
          name: "Manu Sporny", url: "https://www.linkedin.com/in/manusporny/",
          company: "Digital Bazaar", companyURL: "https://digitalbazaar.com/"
        }],

        // extend the bibliography entries
        //localBiblio: webpayments.localBiblio,

        // name of the WG
        wg:           "W3C Credentials Community Group",

        // URI of the public WG page
        wgURI:        "https://www.w3.org/community/credentials/",

        // name (with the @w3c.org) of the public mailing to which comments are due
        wgPublicList: "public-credentials",

        otherLinks: [{
          key: "Source control",
          data: [{
            value: "https://github.com/digitalbazaar/lds-ecdsa-secp384r1-2019/",
            href: "https://github.com/digitalbazaar/lds-ecdsa-secp384r1-2019/"
          }]
        }, {
          key: "Issue Tracker",
          data: [{
            value: "https://github.com/digitalbazaar/lds-ecdsa-secp384r1-2019/issues/",
            href: "https://github.com/digitalbazaar/lds-ecdsa-secp384r1-2019/issues/"
          }]
        }],

        // URI of the patent status for this WG, for Rec-track documents
        // !!!! IMPORTANT !!!!
        // This is important for Rec-track documents, do not copy a patent URI from a random
        // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
        // Team Contact.
        wgPatentURI:  "",
        maxTocLevel: 4,
        /*preProcess: [ webpayments.preProcess ],
        alternateFormats: [ {uri: "diff-20111214.html", label: "diff to previous version"} ],
        */
        localBiblio:  {
          "RDF-DATASET-CANONICALIZATION": {
            title:    "RDF Dataset Canonicalization",
            href:     "https://json-ld.github.io/rdf-dataset-canonicalization/spec/",
            authors:  ["David Longley", "Manu Sporny"],
            status:   "Draft Community Group Report",
            publisher:  "JSON-LD Community Group"
          },
          "SECURITY-VOCABULARY": {
            title:    "Security Linked Data Vocabulary",
            href:     "https://web-payments.org/vocabs/security",
            authors:  ["Manu Sporny","David Longley"],
            status:   "Draft Community Group Report",
            publisher:  "Web Payments Community Group"
          },
          "LD-SIGNATURES": {
            title:    "Linked Data Signatures 1.0",
            href:     "https://w3c-ccg.github.io/ld-signatures/",
            authors:  ["David Longley", "Manu Sporny"],
            status:   "Draft Community Group Report",
            publisher:  "Credentials Community Group"
          }
        }
      };
    </script>
  </head>
  <body>
    <section id='abstract'>
      <p>
This specification describes the Ecdsa Secp384r1 Signature created in 2019 for the
Linked Data Signatures specification.
      </p>
    </section>

    <section id='sotd'>
      <p>
This is an experimental specification and is undergoing regular revisions. It
is not fit for production deployment.
      </p>
    </section>

    <section>
      <h2>Introduction</h2>
      <p>
This specification describes the Ecdsa Secp384r1 Signature created in 2019 for the
Linked Data Signatures [[!LD-SIGNATURES]] specification. It uses the RDF
Dataset Canonicalization Algorithm [[!RDF-DATASET-CANONICALIZATION]] to transform the
input document into its canonical form. It uses SHA-384 [[RFC6234]] as the
<a>message digest algorithm</a> and P-384 defined in [[RFC7797]] as
the <a>signature algorithm</a>.
      </p>
    </section>

    <section>
      <h2>Terminology</h2>
      <p>
The following terms are used throughout this document:
      </p>

      <dl>
        <dt><dfn>signature suite</dfn></dt>
        <dd>
A specified set of cryptographic primitives typically consisting of
a canonicalization algorithm, a message digest algorithm, and a signature
algorithm that are bundled together by cryptographers for developers
for the purposes of safety and convenience.
        </dd>
        <dt><dfn>canonicalization algorithm</dfn></dt>
        <dd>
An algorithm that takes an input document that has more than one possible
representation and always transforms it into a canonical form. This process is
sometimes also called <em>normalization</em>.
        </dd>
        <dt><dfn>message digest algorithm</dfn></dt>
        <dd>
An algorithm that takes an input message and produces a cryptographic
output message that is often many orders of magnitude smaller than the
input message. These algorithms are often 1) very fast, 2)
non-reversible, 3) cause the output to change significantly when even one
bit of the input message changes, and 4) make it infeasible to find two
different inputs for the same output.
        </dd>
        <dt><dfn>signature algorithm</dfn></dt>
        <dd>
An algorithm that takes an input message and produces an output value where the
receiver of the message can mathematically verify that the message has not
been modified in transit and came from someone possessing a particular secret.
        </dd>
      </dl>

      <section>
        <h2>Linked Data Signatures Definitions</h2>
        <p>
The following values are defined by this specification:
        </p>

        <dl>
          <dt><dfn>EcdsaSecp384r1Signature2019</dfn></dt>
          <dd>
A document that complies with the Linked Data Signatures specification has been signed
with EcdsaSecp384r1Signature2019 when it contains a `proof` value, and that
value contains a `type` set to `EcdsaSecp384r1Signature2019`, a `proofPurpose`,
`verificationMethod`, and `proofValue`, as is defined by this specification.
          </dd>

          <dt><dfn>EcdsaSecp384r1VerificationKey2019</dfn></dt>
          <dd>
A Secp384r1 public key. The key MUST contain a `type` set to
`EcdsaSecp384r1VerificationKey2019`, `controller`, and `publicKeyMultibase`
value as defined by this specification.
          </dd>
        </dl>

      </section>

    </section>

    <section>
      <h2>Key Format</h2>

	<section>
      <h2>Examples</h2>

      <p>
An encoded public key example:
      </p>

      <pre class="example highlight">
{
  "@context": ["https://w3id.org/security/suites/ecdsa-2019/v1"],
  "id": "did:example:123456789abcdefghi#keys-1",
  "type": "EcdsaSecp384r1VerificationKey2019",
  "controller": "did:example:123456789abcdefghi",
  "expires": "2020-03-14T04:19:53Z",
  "publicKeyMultibase" : "z82Lm1MpAkeJcix9K8TMiLd5NMAhnwkjjCBeWHXyu3U4oT2MVJJ
                          KXkcVBgjGhnLBn2Kaau9"
}
      </pre>

    </section>
    </section>

    <section>
      <h2>Signature Format</h2>

      <p>
The 2019 Ecdsa Secp384r1 Signature <a>signature suite</a> MUST be used in
conjunction with the signing and verification algorithms in the
Linked Data Signatures [[LD-SIGNATURES]] specification. The suite consists of
the following algorithms:
      </p>

      <table class="simple">
        <thead>
          <th>Parameter</th>
          <th>Value</th>
          <th>Specification</th>
        </thead>
        <tbody>
          <tr>
            <td>canonicalizationAlgorithm</td>
            <td>https://w3id.org/security#GCA2015</td>
            <td>[[RDF-DATASET-CANONICALIZATION]]</td>
          </tr>
          <tr>
            <td>digestAlgorithm</td>
            <td>https://www.iana.org/assignments/cose/cose.xhtml#SHA-384</td>
            <td>[[RFC6234]]</td>
          </tr>
          <tr>
            <td>signatureAlgorithm</td>
            <td>https://www.iana.org/assignments/cose/cose.xhtml#P-384</a></td>
            <td>[[RFC8422]]</td>
          </tr>
        </tbody>

      </table>

    <section>
      <h2>Modification to Algorithms</h2>

      <p>
This signature suite uses ECDSA over Secp384r1 as described in [[RFC8422]].

The steps to construct and verify the digital signature are defined below.
      <p>

      <section>
        <h3>Modifications to Signature Algorithm</h3>

        <p>
The <var>digital signature algorithm</var> defined:
Signature Algorithm takes <var>tbs</var>, a <var>privateKey</var>,
and </var><var>options</var> as inputs and produces a
<var>signatureValue</var> as output.
        </p>
        <ol class="algorithm">
          <li>
Take <var>tbs</var>, which is the data to be signed, an private key and options dictionary as input to the signature suite.
          </li>
          <li>
Perform the digital signature on <var>tbs</var> using the digital signature algorith for P-384 as defined in
<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS-180-4</a> and return the result encoded as <var>signatureValue</var>.
          </li>
          <li>
Multibase encode the <var>signatureValue</var> using base58btc encoding.
          </li>
        </ol>

      </section>

    <section>
        <h3>Modifications to Signature Verification Algorithm</h3>

        <p>
The <var>digital signature algorithm</var> defined
Signature Verification Algorithm takes the value to be verified,
<em>tbv</em>, the <em>public key</em> to the signature algorithm
and returns a boolean value.
        </p>
        <ol class="algorithm">
          <li>
Multibase decode <var>tbv</var> as base58btc and store the result in
<var>rawSignature</var>.
          </li>
          <li>
Take <var>rawSignature</var> and perform the
digital signature verification algorithm for P-384 specified in
<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS-180-4</a>. If the result is a valid signature, return
<code>true</code>, otherwise return <code>false</code>.
          </li>
        </ol>

      </section>

    </section>

    <section>
      <h2>Security Considerations</h2>
      <p>
The following section describes security considerations that developers
implementing this specification should be aware of in order to create secure
software.
      </p>

<div class="issue">TODO: We need to add a complete list of security
considerations.</div>

<ol class="security_considerations">
  <li>
This Signature Suite relies on the security and assumptions made by ECDSA over
Secp384r1. We assume specifcally that sign and verify are implemented safely.
  </li>
</ol>
    </section>

  </body>
</html>
